var b=e=>{throw TypeError(e)};var E=(e,t,i)=>t.has(e)||b("Cannot "+i);var n=(e,t,i)=>(E(e,t,"read from private field"),i?i.call(e):t.get(e)),a=(e,t,i)=>t.has(e)?b("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),f=(e,t,i,o)=>(E(e,t,"write to private field"),o?o.call(e,i):t.set(e,i),i);function R(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var r,l,s,u,m=class{constructor(t,i,o,d){a(this,r);a(this,l);a(this,s);a(this,u);f(this,r,t),f(this,l,i),f(this,s,o),f(this,u,d)}id(){return n(this,r)}remove(){return n(this,u)!==void 0&&clearTimeout(n(this,u)),n(this,s)[n(this,r)]?(delete n(this,s)[n(this,r)],!0):!1}filter(){return{include:new RegExp(`^${R(n(this,r))}$`)}}filterPrefix(){return{include:new RegExp(`^${R(n(this,l))}`)}}};r=new WeakMap,l=new WeakMap,s=new WeakMap,u=new WeakMap;function P(e,t={}){let{prefix:i="eph_",timeout:o=0}=t,{action:d,root:c}=e;d({name:"ephemeral",apply:(v,$={},w={})=>{let{duration:g,prefix:D}=w,x=D??i,p=x+self.crypto.randomUUID();c[p]=$;let h,y=g!==void 0?g:o;return y>0&&(h=setTimeout(()=>{c[p]&&delete c[p]},y)),new m(p,x,c,h)}}),console.log(`Ephemeral signals plugin loaded with default prefix '${i}' and default timeout ${o}ms, @ephemeral() is now available`)}export{P as install};
